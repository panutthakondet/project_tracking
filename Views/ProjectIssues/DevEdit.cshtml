@using Microsoft.AspNetCore.Mvc.Rendering
@using System.Collections.Generic
@model ProjectTracking.Models.ProjectIssue

@{
    ViewData["Title"] = "Dev Edit Issue";
    var devStatusItems = ViewBag.DevStatusList as IEnumerable<SelectListItem> ?? new List<SelectListItem>();
}

<div class="mb-4">
    <h2 class="fw-bold">üë®‚Äçüíª Dev Update Issue</h2>
    <p class="text-muted mb-0">‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÄ‡∏°‡∏≠‡∏£‡πå‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</p>
</div>
<style>
.readonly-text {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
</style>

<div class="card shadow-sm">
    <div class="card-body">

        <div class="mb-3">
            <label class="form-label fw-semibold">üìå Issue</label>
            <div class="form-control bg-light readonly-text" title="@Model.IssueName">@Model.IssueName</div>
        </div>

        <div class="row g-3 mb-3">
            <div class="col-md-6">
                <label class="form-label fw-semibold">üìÅ Project</label>
                <div class="form-control bg-light readonly-text" title="@(Model.Project != null ? Model.Project.ProjectName : "-")">@(Model.Project != null ? Model.Project.ProjectName : "-")</div>
            </div>
            <div class="col-md-6">
                <label class="form-label fw-semibold">üë§ ‡πÅ‡∏à‡πâ‡∏á‡πÇ‡∏î‡∏¢</label>
                <div class="form-control bg-light readonly-text" title="@(Model.Employee != null ? Model.Employee.EmpName : "-")">@(Model.Employee != null ? Model.Employee.EmpName : "-")</div>
            </div>
        </div>

        <form asp-action="DevEdit" asp-route-id="@Model.IssueId" method="post" enctype="multipart/form-data">
            @Html.AntiForgeryToken()
            <input type="hidden" asp-for="IssueId" />

            <div class="mb-3">
                <label class="form-label fw-bold">üõ† Dev Status</label>
                <select asp-for="DevStatus" class="form-select" asp-items="devStatusItems" required></select>
                <small class="text-muted">* TODO/DOING/BLOCK ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ù‡∏±‡πà‡∏á Dev ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡∏à‡∏∞‡∏ï‡∏±‡πâ‡∏á Last Fixed At ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô FIXED</small>
            </div>

            <div class="mb-3">
                <label class="form-label fw-bold">üïí Last Fixed At</label>
                <input class="form-control bg-light" value="@(Model.LastFixedAt.HasValue ? Model.LastFixedAt.Value.ToString("dd/MM/yyyy HH:mm") : "-")" readonly />
                <small class="text-muted">* ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å DevStatus = FIXED</small>
            </div>

            <div class="mb-3">
                <label class="form-label fw-bold">üñº After Images</label>
                <input type="file" name="afterImages" class="form-control" multiple accept="image/*" />
                <small class="text-muted">* ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏π‡∏õ (‡∏†‡∏≤‡∏û‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç)</small>
            </div>

            <div class="text-center mt-4 d-flex justify-content-center gap-2">
                <button type="submit" class="btn btn-primary px-4">üíæ Save</button>
                <a asp-action="DevIndex" asp-route-projectId="@Model.ProjectId" class="btn btn-secondary px-4">‚Ü© Back</a>
            </div>
        </form>

    </div>
</div>