@model ProjectTracking.Models.ProjectIssue

@{
    ViewData["Title"] = "Add Issue";
}

<div class="mb-4">
    <h2 class="fw-bold mb-1">‚ûï Add Project Issue</h2>
    <p class="text-muted mb-0">
        ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Issue / Bug / ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö‡πÉ‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£
    </p>
</div>

<div class="card shadow-sm">
    <div class="card-body">

        <form asp-action="Create"
              method="post"
              enctype="multipart/form-data">

            @Html.AntiForgeryToken()

            <!-- ProjectId -->
            <input type="hidden" asp-for="ProjectId" />

            <!-- ‚úÖ IMPORTANT: ‡∏Å‡∏±‡∏ô‡∏Ñ‡πà‡∏≤‡∏ñ‡∏π‡∏Å bind ‡πÅ‡∏õ‡∏•‡∏Å ‡πÜ ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏≠‡∏Å -->
            <!-- (Controller ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡∏à‡∏£‡∏¥‡∏á‡∏≠‡∏µ‡∏Å‡∏ó‡∏µ) -->
            <input type="hidden" asp-for="IsReopen" value="false" />
            <input type="hidden" asp-for="ReopenCount" value="0" />

            <div class="row g-3">

                <!-- Issue Name -->
                <div class="col-md-12">
                    <label class="form-label fw-semibold">üêû Issue Name</label>
                    <input asp-for="IssueName"
                           class="form-control"
                           placeholder="Describe the issue" />
                    <span asp-validation-for="IssueName" class="text-danger"></span>
                </div>

                <!-- Owner -->
                <div class="col-md-6">
                    <label class="form-label fw-semibold">üë§ Owner (Employee)</label>

                    <select asp-for="EmpId"
                            asp-items="ViewBag.Employees"
                            class="form-select">
                        <option value="">-- Select Employee --</option>
                    </select>

                    <span asp-validation-for="EmpId" class="text-danger"></span>
                </div>

                <!-- Status -->
                <div class="col-md-3">
                    <label class="form-label fw-semibold">üìå Status</label>
                    <select asp-for="IssueStatus"
                            asp-items="ViewBag.StatusList"
                            class="form-select">
                    </select>
                </div>

                <!-- Priority -->
                <div class="col-md-3">
                    <label class="form-label fw-semibold">üö® Priority</label>
                    <select asp-for="IssuePriority" class="form-select">
                        <option value="NORMAL">Normal</option>
                        <option value="URGENT">Urgent</option>
                    </select>
                </div>

                <!-- ‚úÖ NOTE:
                     ‡∏™‡πà‡∏ß‡∏ô CreatedAt / IsReopen / ReopenCount / LastFixedAt
                     ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ "‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏£‡∏≠‡∏Å" ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ Yesterday/Trend ‡πÄ‡∏û‡∏µ‡πâ‡∏¢‡∏ô
                     ‡πÉ‡∏´‡πâ Controller ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô set:
                     - CreatedAt = DateTime.Now
                     - IsReopen = false
                     - ReopenCount = 0
                     - LastFixedAt = null
                -->

                <!-- BEFORE IMAGES -->
                <div class="col-md-12">
                    <label class="form-label fw-semibold text-primary">
                        üßæ Issue Images (Before Fix)
                    </label>

                    <input type="file"
                           name="images"
                           class="form-control"
                           multiple
                           accept="image/*" />

                    <small class="text-muted">
                        ‡πÅ‡∏ô‡∏ö‡∏£‡∏π‡∏õ‡∏ï‡∏≠‡∏ô‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ‚Ä¢ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏π‡∏õ (jpg / png)
                    </small>
                </div>

            </div>

            <div class="mt-4 d-flex gap-2">
                <button type="submit" class="btn btn-primary">
                    üíæ Save Issue
                </button>

                <a asp-action="Index"
                   asp-route-projectId="@Model.ProjectId"
                   class="btn btn-outline-secondary">
                    ‚Ü© Back
                </a>
            </div>

        </form>

    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}