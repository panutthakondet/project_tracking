@model IEnumerable<ProjectTracking.Models.VwPhaseOwnerStatus>
@{
    Layout = null; // ❗ สำคัญสำหรับหน้าพิมพ์
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Phase Owner Status Report</title>

    <style>
        body {
            font-family: Tahoma, Arial;
            font-size: 11px;
        }

        h2 {
            text-align: center;
            margin-bottom: 5px;
        }

        .meta {
            margin-bottom: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            border: 1px solid #000;
            padding: 4px;
            vertical-align: top;
        }

        th {
            background: #eee;
        }

        /* ✅ Razor-safe */
        @@page {
            size: A4 landscape;
            margin: 10mm;
        }
    </style>
</head>

<body onload="window.print()">

<h2>Phase Owner Status Report</h2>

<div class="meta">
    <b>Project:</b> @(ViewBag.ProjectName ?? "All") <br />
    <b>Employee:</b> @(ViewBag.EmpName ?? "All") <br />
    <b>Printed:</b> @ViewBag.PrintDate.ToString("dd/MM/yyyy HH:mm")
</div>

<table>
    <thead>
        <tr>
            <th>Project</th>
            <th>Order</th>
            <th>Employee</th>
            <th>Role</th>
            <th>Plan</th>
            <th>Actual</th>
            <th>Plan Days</th>
            <th>Actual Days</th>
            <th>Overdue</th>
            <th>Status</th>
            <th>Remark</th>
        </tr>
    </thead>
    <tbody>
    @foreach (var r in Model)
    {
        <tr>
            <td>@r.ProjectName</td>
            <td style="text-align:center">@r.PhaseOrder</td>
            <td>@r.EmpName</td>
            <td>@r.Role</td>
            <td>
                @r.PlanStart?.ToString("dd/MM/yyyy")
                -
                @r.PlanEnd?.ToString("dd/MM/yyyy")
            </td>
            <td>
                @r.ActualStart?.ToString("dd/MM/yyyy")
                -
                @r.ActualEnd?.ToString("dd/MM/yyyy")
            </td>
            <td style="text-align:center">@r.PlanDays</td>
            <td style="text-align:center">@r.ActualDays</td>
            <td style="text-align:center">@r.OverdueDays</td>
            <td>@r.PhaseStatus</td>
            <td>@r.Remark</td>
        </tr>
    }
    </tbody>
</table>

</body>
</html>